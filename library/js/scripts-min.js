!function($){function position_vertically(){var e=$(".sidebar"),t=e.outerHeight(),n=$(window).height();e.add(".cover-nav").css("margin-top",(n-t)/2)}function responsive_video_setup(){$all_videos.each(function(){var e=$(this);e.data("aspect_ratio",$(this).attr("height")/$(this).attr("width")).height(e.width()*e.data("aspect_ratio"))}),window.requestAnimationFrame(resize_videos)}function resize_videos(){window.requestAnimationFrame(resize_videos);var e=$all_videos.first().width(),t=$(".glass-post-body .glass-wrapper").width();t!==e&&$all_videos.each(function(){var e=$(this);e.width(t).height(t*e.data("aspect_ratio"))})}function set_history(){"undefined"!=typeof history.replaceState&&history.replaceState({slug:location.pathname.replace("/","")},null,null),window.onpopstate=function(){load_new_page(location.href,!0)}}function update_history(e,t){history.pushState({slug:e},t,e)}function page_scroll(e,t){$("html,body").stop().animate({scrollTop:e},t)}function toggle_sidebar(e){var t=$(".sidebar, .menu-toggle");t.is(e.target)||0!==t.has(e.target).length||($content.removeClass("slide"),$sidebar.addClass("transparent"))}function set_menu_toggle(){$document.on("click",".menu-toggle",function(e){e.preventDefault(),$sidebar.toggleClass("transparent"),$content.toggleClass("slide")}),$document.mouseup(function(e){toggle_sidebar(e)}).on("touchend",function(e){toggle_sidebar(e)})}function activate_internal_links(){$document.on("click",'a[href^="'+site_url+'"], a[href^="/"], a[href^="./"], a[href^="../"]',function(e){var t=$(this),n=t.attr("href");load_new_page(n),$('a[href="'+n+'"').addClass("current_link").parent().addClass("current_page_item"),e.preventDefault()}),$document.on("click",".page-numbers",function(){page_scroll(0,500)})}function load_new_page(e,t){$internal_links.removeClass("current_link"),$(".current_page_item").removeClass("current_page_item"),"undefined"==typeof t&&(t=!1),$.get(e,function(n){var a=$(n),s=$("#dynamic",a).html(),i=a.filter("title").text();add_css(a.filter('link[rel="stylesheet"]'),!0);var r=n.replace(/<script/gi,"<albascript").replace(/<\/script/gi,"</albascript");add_js($(r).filter("albascript"),!0),"undefined"==typeof history.pushState&&(location.href=e),t||update_history(e,i),$dynamic.html(s),e.slice(0,-1)===site_url?(position_vertically(),$dynamic.addClass("cover")):$dynamic.removeClass("cover")}).done(function(){$sidebar.addClass("transparent"),$dynamic.removeClass("slide")})}function add_js($scripts,run){$scripts.each(function(){var src=$(this).attr("src");src?-1===$.inArray(src,external_js)&&(external_js.push(src),run&&$.getScript(src)):eval($(this).text())}),window.console.log("scripts.length = "+$scripts.length),window.console.log("external_js.length = "+external_js.length),window.console.log("external_js = "),window.console.log(external_js)}function add_css(e,t){e.each(function(){var e=$(this).attr("href");-1===$.inArray(e,external_css)&&(external_css.push(e),t&&$("head").append('<link rel="stylesheet" type="text/css" href="'+e+'">'))})}function init(){set_history(),position_vertically(),responsive_video_setup(),activate_internal_links(),set_menu_toggle(),add_css($('link[rel="stylesheet"]'),!1),add_js($("script"),!1)}var site_url=albatross_vars.site_url,$document=$(document),$dynamic=$("#dynamic"),$content=$(".content"),$sidebar=$(".sidebar"),$all_videos=$('iframe[src*="//www.youtube.com"], iframe[src*="//player.vimeo.com"]'),$internal_links=$('a[href^="'+site_url+'"], a[href^="/"], a[href^="./"], a[href^="../"]'),external_js=[],external_css=[];init()}(jQuery);